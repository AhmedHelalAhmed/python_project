{% extends 'web/base.html' %}
<!-- {% load static %} -->
{% block body %}
<!DOCTYPE html>
<!-- {% load staticfiles %} -->
<html>
<head>

    <!-- Required meta tags for Bootstrap -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css">


    <title>
        Post Page
    </title>

    <style>

        /*.comment_area {*/

        /*border: 2px solid #bbb;*/

        /*}*/


    </style>
</head>

<body>
<!-- Navigation Bar -->
 
 
<nav class=" sticky-top navbar navbar-expand-lg navbar-dark bg-dark">
    <a class="navbar-brand" href="#">Navbar</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
            <li class="nav-item active">
                <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Features</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Pricing</a>
            </li>
            <li class="nav-item">
                <a class="nav-link disabled" href="#">Disabled</a>
            </li>
        </ul>
    </div>

</nav>
<br>
<div class="ui-widget">
    <label for="posts">Search</label>
    <input id="posts">
    
</div>

<div class="container">
    <div class="row mt-5">

        <!-- Sidebar -->
        <div class="list-group col-4 col-xl-3 mt-2">
            <a href="#" class="list-group-item list-group-item-action flex-column align-items-start">
                <div class="d-flex w-100 justify-content-between">
                    <h5 class="mb-1">List group item heading</h5>
                    <small>3 days ago</small>
                </div>
                <p class="mb-1">Donec id elit non mi porta gravida at eget metus. Maecenas sed diam eget risus varius
                    blandit.</p>
                <small>Donec id elit non mi porta.</small>
            </a>
            <a href="#" class="list-group-item list-group-item-action flex-column align-items-start">
                <div class="d-flex w-100 justify-content-between">
                    <h5 class="mb-1">List group item heading</h5>
                    <small class="text-muted">3 days ago</small>
                </div>
                <p class="mb-1">Donec id elit non mi porta gravida at eget metus. Maecenas sed diam eget risus varius
                    blandit.</p>
                <small class="text-muted">Donec id elit non mi porta.</small>
            </a>
            <a href="#" class="list-group-item list-group-item-action flex-column align-items-start">
                <div class="d-flex w-100 justify-content-between">
                    <h5 class="mb-1">List group item heading</h5>
                    <small class="text-muted">3 days ago</small>
                </div>
                <p class="mb-1">Donec id elit non mi porta gravida at eget metus. Maecenas sed diam eget risus varius
                    blandit.</p>
                <small class="text-muted">Donec id elit non mi porta.</small>
            </a>
        </div>
        <!-- Article -->
        <div class="text-center col-8 col-xl-9 mt-2">
            <h1>Title of the post</h1>
            <div style="height:500px">
                <img class="mw-100 mh-100" src= "{% static 'bloggawy/images/technology1.jpg'%}" ></img>
            </div>
            <p class="mt-1">Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque
                
               
                vel illum qui dolorem eum fugiat quo voluptas nulla pariatur</p>
        </div>
    </div>


    <br/><br/><br/><br/><br/>


    <center>


    </center>


    <div class="card">
        <div class="card-header text-center">


            <div class="container">
                <div class="btn-group"></div>
                <div class="btn btn-success btn-lg active like">
                    {% if like.like_type == True %}
                    <span class="like-text">liked</span>
                    {% else %}
                    <span class="like-text">like</span>
                    {% endif %}
                    <span id="likecount" class="badge badge-light">{{ likes }}</span>
                </div>
                <div class="btn btn-danger btn-lg active dislike">
                    {% if like.like_type == False %}
                    <span class="dislike-text">disliked</span>
                    {% else %}
                    <span class="dislike-text">dislike</span>
                    {% endif %}
                    <span id="dislikecount" class="badge badge-light">{{ dislikes }}</span>
                </div>
            </div>


        </div>
        <div class="card-body text-center">
            <p class="card-text">


            <form method="POST">{% csrf_token %}
                {{ form.errors }}
                {{ form.comment_content }}
                <!--{{ form.as_p }}-->
                <div>

                    <button type="submit" class="btn btn-primary mb-2">Add comment</button>
                </div>


            </form>


            </p>

        </div>
        <div class="card-footer text-muted">


            <div class="comment_area">
                <h3 class="border-bottom border-gray pb-2 mb-0 text-left" style=' width: 200px'>Comments</h3>

                <!--i will modify the img field later-->
                {% for comment in comments %}

                <div class="media text-muted pt-3">
                    <img data-src="holder.js/32x32?theme=thumb&amp;
            bg=007bff&amp;fg=007bff&amp;size=1" alt="32x32"
                         class="mr-2 rounded" style="width: 32px;
                  height: 32px;" src="{%  static 'bloggawy/images/commentphoto.png' %}" data-holder-rendered="true">
                    <p style='padding: 3px; word-break: break-all; word-wrap: break-word;'
                       class="media-body pb-3 mb-0 small lh-125 border-bottom border-gray col-6 col-md-8" width="100">
                        <strong class="d-block text-gray-dark">@{{comment.comment_user.username}} on
                            {{comment.comment_time}}</strong>

                        {{ comment.comment_content|linebreaksbr }}

                    </p>
                </div>

                {% endfor %}


            </div>

            <!--enhancement make the url with ajax-->
            <small class="d-block text-right mt-3">
                <!--this is enhancement-->
                <a href="#">All comments</a>
            </small>


        </div>
    </div>


    <!-- Pagination -->
    <div class="row">
        <div class="col-6"></div>
        <div class="text-center col-6">
            <nav aria-label="Page navigation example">
                <ul class="pagination">
                    <li class="page-item">
                        <a class="page-link" href="#" aria-label="Previous">
                            <span aria-hidden="true">&laquo;</span>
                            <span class="sr-only">Previous</span>
                        </a>
                    </li>
                    <li class="page-item"><a class="page-link" href="#">1</a></li>
                    <li class="page-item"><a class="page-link" href="#">2</a></li>
                    <li class="page-item"><a class="page-link" href="#">3</a></li>
                    <li class="page-item">
                        <a class="page-link" href="#" aria-label="Next">
                            <span aria-hidden="true">&raquo;</span>
                            <span class="sr-only">Next</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"> </script>
<!-- jQuery UI !-->

<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>



<script>
    $(function(){
        
    $('#posts').autocomplete({
       source:"get_post/",

       select: function (event, ui) {
            window.location ="/bloggawy/post/" + ui.item.id
        },
       minLength: 2,
    });

   
     
    $('#id_comment_content').on("keyup", function () {
        var maxrows = 10;
        var txt = this.value;
        var cols = this.cols;

        var arraytxt = txt.split('\n');
        var rows = arraytxt.length;

        for (i = 0; i < arraytxt.length; i++) {
            rows += parseInt(arraytxt[i].length / cols);
        }

        if (rows > maxrows) {
            this.rows = maxrows;
        }
        else {
            this.rows = rows;
        }
    });

    var like_status = "";

    $(".like").on("click", function (event) {

        if ($(".like-text").html() == "like") {
            if ($(".dislike-text").html() == "disliked") {
                $(".dislike-text").html("dislike");
                $("#dislikecount").html(parseInt($("#dislikecount").html()) - 1);

            }
            $(".like-text").html("liked");
            $("#likecount").html(parseInt($("#likecount").html()) + 1);
        }
        else {
            $(".like-text").html("like");
            $("#likecount").html(parseInt($("#likecount").html()) - 1);
        }


        var url = window.location + "/like/";
        //alert(url);
        $.ajax({
            url: url,
            success: function () {
                // alert("like done");
            }
        });


    });

    $(".dislike").on("click", function (event) {

        if ($(".dislike-text").html() == "dislike") {
            if ($(".like-text").html() == "liked") {
                $(".like-text").html("like");
                $("#likecount").html(parseInt($("#likecount").html()) - 1);
            }
            $(".dislike-text").html("disliked");
            $("#dislikecount").html(parseInt($("#dislikecount").html()) + 1);

        }
        else {
            $(".dislike-text").html("dislike");
            $("#dislikecount").html(parseInt($("#dislikecount").html()) - 1);
        }

        var url = window.location + "/dislike/";
        //alert(url);
        $.ajax({
            url: url,
            success: function () {
                // alert("dislike done");
            }
        });

    });
});
</script>
</body>
<!-- {% endblock %} -->
</html>